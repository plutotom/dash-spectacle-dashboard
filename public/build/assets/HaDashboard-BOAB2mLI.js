import{b as h,j as t,r as c,R as m}from"./app-BBNs4zuK.js";import{H as E}from"./HaDashboardLayout-Bh_ar8bf.js";const O={async getEvents(){return(await h.get("/api/calendar-events")).data.data}};function D({dayEvents:e,dayDate:r}){return e.length?t.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[t.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),t.jsx("hr",{className:"border-[0.5px] border-gray-400"}),e.map(n=>t.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:t.jsx(C,{event:n})},n.id))]}):null}function C({event:e}){return e.isAllDay?t.jsx("div",{children:t.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[t.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),t.jsx("span",{children:e.summary})]})}):t.jsx("div",{children:t.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[t.jsxs("span",{children:[new Date(e.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(e.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),t.jsx("span",{children:e.summary})]})})}function L({className:e}){const[r,n]=c.useState(null),[a,l]=c.useState(!0),[i,s]=c.useState(null),[d,o]=c.useState(null);return c.useEffect(()=>{const f=async()=>{try{const v=await O.getEvents();n(v),o(new Date),s(null)}catch(v){s("Failed to fetch calendar events"),console.error(v)}finally{l(!1)}};f();const u=setInterval(f,20*60*1e3);return()=>clearInterval(u)},[]),a?t.jsx("div",{className:"flex items-center justify-center p-4",children:t.jsx("div",{className:"",children:"Loading Calendar..."})}):i?t.jsxs("div",{className:"p-4 text-destructive",children:["Error loading calendar: ",i]}):t.jsx("div",{className:`rounded-lg shadow-sm ${e}`,children:t.jsx("div",{children:t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("span",{className:"text-sm text-muted-foreground",style:{display:"none"},children:["Last updated: ",d==null?void 0:d.toLocaleString()]}),r&&Object.keys(r).length>0?Object.values(r).slice(0,4).map((f,u)=>t.jsx("div",{className:"w-1/4",children:t.jsx(D,{dayEvents:f,dayDate:Object.keys(r)[u]},u)},u)):t.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})})})}function P(){const[e,r]=c.useState([]),[n,a]=c.useState(!0),[l,i]=c.useState(null);return c.useEffect(()=>{const s=async()=>{try{const o=await h.get("/api/messages");i(null),r(o.data.data),a(!1)}catch(o){i("Failed"+JSON.stringify(o)),a(!1)}};s();const d=setInterval(()=>{s()},1e3*60*1);return()=>clearInterval(d)},[]),n?t.jsx("div",{children:"Loading messages..."}):l?t.jsx("div",{className:"text-red-500",children:l}):t.jsx("div",{className:"",children:t.jsx("div",{className:"max-h-[30vh] overflow-y-auto",children:e.map(s=>t.jsxs("div",{className:"my-1 flex flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[t.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[t.jsx("span",{className:"text-xs font-medium",children:s.name}),t.jsx("span",{children:new Date(s.created_at).toLocaleTimeString()})]}),t.jsx("p",{className:"text-sm text-white",children:s.content})]},s.id))})})}const w={async getCurrentWeather(){return(await h.get("/api/weather/current")).data.data},async getForecast(){return(await h.get("/api/weather/forecast")).data.data}};var N={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},y=m.createContext&&m.createContext(N),T=["attr","size","title"];function I(e,r){if(e==null)return{};var n=B(e,r),a,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(l=0;l<i.length;l++)a=i[l],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function B(e,r){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(r.indexOf(a)>=0)continue;n[a]=e[a]}return n}function x(){return x=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},x.apply(this,arguments)}function b(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function g(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?b(Object(n),!0).forEach(function(a){M(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function M(e,r,n){return r=F(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function F(e){var r=W(e,"string");return typeof r=="symbol"?r:r+""}function W(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function S(e){return e&&e.map((r,n)=>m.createElement(r.tag,g({key:n},r.attr),S(r.child)))}function _(e){return r=>m.createElement(k,x({attr:g({},e.attr)},r),S(e.child))}function k(e){var r=n=>{var{attr:a,size:l,title:i}=e,s=I(e,T),d=l||n.size||"1em",o;return n.className&&(o=n.className),e.className&&(o=(o?o+" ":"")+e.className),m.createElement("svg",x({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,a,s,{className:o,style:g(g({color:e.color||n.color},n.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),i&&m.createElement("title",null,i),e.children)};return y!==void 0?m.createElement(y.Consumer,null,n=>r(n)):r(N)}function z(e){return _({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 11c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 2c0-3.31-2.69-6-6-6s-6 2.69-6 6c0 2.22 1.21 4.15 3 5.19l1-1.74c-1.19-.7-2-1.97-2-3.45 0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.48-.81 2.75-2 3.45l1 1.74c1.79-1.04 3-2.97 3-5.19zM12 3C6.48 3 2 7.48 2 13c0 3.7 2.01 6.92 4.99 8.65l1-1.73C5.61 18.53 4 15.96 4 13c0-4.42 3.58-8 8-8s8 3.58 8 8c0 2.96-1.61 5.53-4 6.92l1 1.73c2.99-1.73 5-4.95 5-8.65 0-5.52-4.48-10-10-10z"},child:[]}]})(e)}function A(){const[e,r]=c.useState(null),[n,a]=c.useState(!0),[l,i]=c.useState(null),[s,d]=c.useState(null);return c.useEffect(()=>{const o=async()=>{try{i(null);const u=await w.getCurrentWeather();console.log(u),r(u),d(new Date)}catch(u){i("Failed to fetch current weather"),console.error(u)}finally{a(!1)}};o();const f=setInterval(o,15*60*1e3);return()=>clearInterval(f)},[]),n?t.jsx("div",{className:"flex items-center justify-center p-4",children:t.jsx("div",{className:"",children:"Loading Weather..."})}):l?t.jsxs("div",{className:"p-4 text-destructive",children:["Error loading weather: ",l]}):t.jsx("div",{className:"h-40 w-full",children:t.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:t.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[t.jsx("div",{className:"flex flex-row gap-1 align-middle",children:t.jsxs("h1",{className:"text-5xl",children:[e==null?void 0:e.current.home_assistant_current_temp,"째"]})}),t.jsxs("div",{className:"flex flex-row items-center gap-1",children:[t.jsx(z,{}),t.jsxs("h3",{className:"text-base",children:[e.current.temp_f,"째"]})]}),t.jsx("div",{className:"text-small text-muted-foreground",children:s==null?void 0:s.toLocaleString()})]})})})}function R(e){const r=new Date;r.setHours(0,0,0,0);const n=new Date(e);n.setHours(0,0,0,0);const a=(n.getTime()-r.getTime())/(1e3*60*60*24);return a===0?"Today":a===1?"Tomorrow":a<7&&a>1?`Next ${n.toLocaleDateString(void 0,{weekday:"long"})}`:n.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}const H=()=>{const[e,r]=c.useState(null),[n,a]=c.useState(!0),[l,i]=c.useState(null);return c.useEffect(()=>{const s=async()=>{try{const o=await w.getForecast();r(o),i(new Date)}catch(o){console.error("Failed to load forecast:",o)}finally{a(!1)}};s();const d=setInterval(s,20*60*1e3);return()=>clearInterval(d)},[]),n?t.jsx("div",{children:"Loading forecast..."}):e?t.jsx("div",{className:"space-y-2",children:t.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:e.forecast.map(s=>t.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[t.jsx("div",{className:"text-lg font-semibold",children:R(new Date(s.date+"T00:00:00")).replace("Next ","")}),t.jsxs("div",{children:[t.jsx("img",{src:s.day.condition.icon,alt:s.day.condition.text,className:"mx-auto h-16 w-16"}),t.jsxs("div",{className:"text-center align-baseline",children:[t.jsxs("div",{className:"text-lg",children:[t.jsxs("span",{className:"",children:[Math.round(s.day.maxtemp_f),"째"]})," / ",t.jsxs("span",{className:"",children:[Math.round(s.day.mintemp_f),"째"]})]}),t.jsxs("div",{className:"text text-sm text-gray-400",children:[s.day.daily_chance_of_rain,"%"]}),t.jsx("span",{className:"none",children:l==null?void 0:l.toLocaleTimeString()})]})]})]},s.date_epoch))})}):t.jsx("div",{children:"Unable to load forecast"})},U=c.createContext(null),j={didCatch:!1,error:null};class K extends c.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=j}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var n,a,l=arguments.length,i=new Array(l),s=0;s<l;s++)i[s]=arguments[s];(n=(a=this.props).onReset)===null||n===void 0||n.call(a,{args:i,reason:"imperative-api"}),this.setState(j)}}componentDidCatch(r,n){var a,l;(a=(l=this.props).onError)===null||a===void 0||a.call(l,r,n)}componentDidUpdate(r,n){const{didCatch:a}=this.state,{resetKeys:l}=this.props;if(a&&n.error!==null&&G(r.resetKeys,l)){var i,s;(i=(s=this.props).onReset)===null||i===void 0||i.call(s,{next:l,prev:r.resetKeys,reason:"keys"}),this.setState(j)}}render(){const{children:r,fallbackRender:n,FallbackComponent:a,fallback:l}=this.props,{didCatch:i,error:s}=this.state;let d=r;if(i){const o={error:s,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")d=n(o);else if(a)d=c.createElement(a,o);else if(l!==void 0)d=l;else throw s}return c.createElement(U.Provider,{value:{didCatch:i,error:s,resetErrorBoundary:this.resetErrorBoundary}},d)}}function G(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==r.length||e.some((n,a)=>!Object.is(n,r[a]))}function p({children:e,intervalMs:r}){const[n,a]=c.useState(0);return c.useEffect(()=>{if(n===0)return;const l=setTimeout(()=>a(i=>i+1),r);return()=>clearTimeout(l)},[n,r]),t.jsx(K,{fallbackRender:()=>t.jsxs("div",{children:["Something went wrong. Retrying in ",r/6e4," minutes..."]}),onReset:()=>a(l=>l+1),resetKeys:[n],children:e})}function V(){return t.jsx(E,{header:t.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:t.jsxs("div",{className:"relative flex h-screen flex-col gap-4 p-4",children:[t.jsx(J,{}),t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"text-5xl text-primary-foreground",children:new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-3xl text-primary-foreground",children:new Date().toLocaleDateString("en-US",{weekday:"long"})}),t.jsx("span",{className:"text-lg text-primary-foreground",children:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),t.jsx("div",{className:"w-1/4",children:t.jsx(A,{})})]}),t.jsx("div",{className:"flex flex-1 gap-4",children:t.jsx("div",{className:"w-full",children:t.jsx(p,{intervalMs:1e3*60*1,children:t.jsx(H,{})})})}),t.jsx("div",{className:"flex w-full items-center justify-start lg:w-1/2",children:t.jsx("div",{className:"w-full",children:t.jsx(p,{intervalMs:1e3*60*1,children:t.jsx(P,{})})})}),t.jsx("div",{className:"h-1/3",children:t.jsx(p,{intervalMs:1e4,children:t.jsx(L,{})})})]})})}function J(){return t.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:`
        linear-gradient(to bottom,
            rgba(0, 0, 0, 0.2) 50%,
            rgba(0, 0, 0, 0) 20%,
            rgba(0, 0, 0, 0) 30%,
            rgba(0, 0, 0, .2) 50%
        )
    `}})}export{V as default};
//# sourceMappingURL=HaDashboard-BOAB2mLI.js.map
