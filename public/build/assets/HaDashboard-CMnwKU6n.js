import{b as h,j as e,r as c,R as m}from"./app-D18Er4wJ.js";import{H as E}from"./HaDashboardLayout-BN_YHsKw.js";const O={async getEvents(){return(await h.get("/api/calendar-events")).data.data}};function D({dayEvents:t,dayDate:r}){return t.length?e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),t.map(n=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(C,{event:n})},n.id))]}):null}function C({event:t}){return t.isAllDay?e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),e.jsx("span",{children:t.summary})]})}):e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(t.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(t.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:t.summary})]})})}function L({className:t}){const[r,n]=c.useState(null),[s,l]=c.useState(!0),[i,a]=c.useState(null),[d,o]=c.useState(null);return c.useEffect(()=>{const f=async()=>{try{const v=await O.getEvents();n(v),o(new Date),a(null)}catch(v){a("Failed to fetch calendar events"),console.error(v)}finally{l(!1)}};f();const u=setInterval(f,20*60*1e3);return()=>clearInterval(u)},[]),s?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):i?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading calendar: ",i]}):e.jsx("div",{className:`rounded-lg shadow-sm ${t}`,children:e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",style:{display:"none"},children:["Last updated: ",d==null?void 0:d.toLocaleString()]}),r&&Object.keys(r).length>0?Object.values(r).slice(0,4).map((f,u)=>e.jsx("div",{className:"w-1/4",children:e.jsx(D,{dayEvents:f,dayDate:Object.keys(r)[u]},u)},u)):e.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})})})}function P(){const[t,r]=c.useState([]),[n,s]=c.useState(!0),[l,i]=c.useState(null);return c.useEffect(()=>{const a=async()=>{try{const o=await h.get("/api/messages");i(null),r(o.data.data),s(!1)}catch(o){i("Failed"+JSON.stringify(o)),s(!1)}};a();const d=setInterval(()=>{a()},1e3*60*1);return()=>clearInterval(d)},[]),n?e.jsx("div",{children:"Loading messages..."}):l?e.jsx("div",{className:"text-red-500",children:l}):e.jsx("div",{className:"",children:e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",children:t.map(a=>e.jsxs("div",{className:"my-1 flex w-1/3 flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:a.name}),e.jsx("span",{children:new Date(a.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:a.content})]},a.id))})})}const w={async getCurrentWeather(){return(await h.get("/api/weather/current")).data.data},async getForecast(){return(await h.get("/api/weather/forecast")).data.data}};var N={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},y=m.createContext&&m.createContext(N),T=["attr","size","title"];function I(t,r){if(t==null)return{};var n=B(t,r),s,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(l=0;l<i.length;l++)s=i[l],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function B(t,r){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(r.indexOf(s)>=0)continue;n[s]=t[s]}return n}function x(){return x=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},x.apply(this,arguments)}function b(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,s)}return n}function g(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?b(Object(n),!0).forEach(function(s){M(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function M(t,r,n){return r=F(r),r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function F(t){var r=W(t,"string");return typeof r=="symbol"?r:r+""}function W(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,r||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function S(t){return t&&t.map((r,n)=>m.createElement(r.tag,g({key:n},r.attr),S(r.child)))}function _(t){return r=>m.createElement(k,x({attr:g({},t.attr)},r),S(t.child))}function k(t){var r=n=>{var{attr:s,size:l,title:i}=t,a=I(t,T),d=l||n.size||"1em",o;return n.className&&(o=n.className),t.className&&(o=(o?o+" ":"")+t.className),m.createElement("svg",x({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,a,{className:o,style:g(g({color:t.color||n.color},n.style),t.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),i&&m.createElement("title",null,i),t.children)};return y!==void 0?m.createElement(y.Consumer,null,n=>r(n)):r(N)}function z(t){return _({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 11c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 2c0-3.31-2.69-6-6-6s-6 2.69-6 6c0 2.22 1.21 4.15 3 5.19l1-1.74c-1.19-.7-2-1.97-2-3.45 0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.48-.81 2.75-2 3.45l1 1.74c1.79-1.04 3-2.97 3-5.19zM12 3C6.48 3 2 7.48 2 13c0 3.7 2.01 6.92 4.99 8.65l1-1.73C5.61 18.53 4 15.96 4 13c0-4.42 3.58-8 8-8s8 3.58 8 8c0 2.96-1.61 5.53-4 6.92l1 1.73c2.99-1.73 5-4.95 5-8.65 0-5.52-4.48-10-10-10z"},child:[]}]})(t)}function A(){const[t,r]=c.useState(null),[n,s]=c.useState(!0),[l,i]=c.useState(null),[a,d]=c.useState(null);return c.useEffect(()=>{const o=async()=>{try{i(null);const u=await w.getCurrentWeather();console.log(u),r(u),d(new Date)}catch(u){i("Failed to fetch current weather"),console.error(u)}finally{s(!1)}};o();const f=setInterval(o,15*60*1e3);return()=>clearInterval(f)},[]),n?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):l?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading weather: ",l]}):e.jsx("div",{className:"h-40 w-full",children:e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsx("div",{className:"flex flex-row gap-1 align-middle",children:e.jsxs("h1",{className:"text-5xl",children:[t==null?void 0:t.current.home_assistant_current_temp,"째"]})}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[e.jsx(z,{}),e.jsxs("h3",{className:"text-base",children:[t.current.temp_f,"째"]})]}),e.jsx("div",{className:"text-small text-muted-foreground",children:a==null?void 0:a.toLocaleString()})]})})})}function R(t){const r=new Date;r.setHours(0,0,0,0);const n=new Date(t);n.setHours(0,0,0,0);const s=(n.getTime()-r.getTime())/(1e3*60*60*24);return s===0?"Today":s===1?"Tomorrow":s<7&&s>1?`Next ${n.toLocaleDateString(void 0,{weekday:"long"})}`:n.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}const H=()=>{const[t,r]=c.useState(null),[n,s]=c.useState(!0),[l,i]=c.useState(null);return c.useEffect(()=>{const a=async()=>{try{const o=await w.getForecast();r(o),i(new Date)}catch(o){console.error("Failed to load forecast:",o)}finally{s(!1)}};a();const d=setInterval(a,20*60*1e3);return()=>clearInterval(d)},[]),n?e.jsx("div",{children:"Loading forecast..."}):t?e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:t.forecast.map(a=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:R(new Date(a.date+"T00:00:00")).replace("Next ","")}),e.jsxs("div",{children:[e.jsx("img",{src:a.day.condition.icon,alt:a.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(a.day.maxtemp_f),"째"]})," / ",e.jsxs("span",{className:"",children:[Math.round(a.day.mintemp_f),"째"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[a.day.daily_chance_of_rain,"%"]}),e.jsx("span",{className:"none",children:l==null?void 0:l.toLocaleTimeString()})]})]})]},a.date_epoch))})}):e.jsx("div",{children:"Unable to load forecast"})},U=c.createContext(null),j={didCatch:!1,error:null};class K extends c.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=j}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var n,s,l=arguments.length,i=new Array(l),a=0;a<l;a++)i[a]=arguments[a];(n=(s=this.props).onReset)===null||n===void 0||n.call(s,{args:i,reason:"imperative-api"}),this.setState(j)}}componentDidCatch(r,n){var s,l;(s=(l=this.props).onError)===null||s===void 0||s.call(l,r,n)}componentDidUpdate(r,n){const{didCatch:s}=this.state,{resetKeys:l}=this.props;if(s&&n.error!==null&&G(r.resetKeys,l)){var i,a;(i=(a=this.props).onReset)===null||i===void 0||i.call(a,{next:l,prev:r.resetKeys,reason:"keys"}),this.setState(j)}}render(){const{children:r,fallbackRender:n,FallbackComponent:s,fallback:l}=this.props,{didCatch:i,error:a}=this.state;let d=r;if(i){const o={error:a,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")d=n(o);else if(s)d=c.createElement(s,o);else if(l!==void 0)d=l;else throw a}return c.createElement(U.Provider,{value:{didCatch:i,error:a,resetErrorBoundary:this.resetErrorBoundary}},d)}}function G(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==r.length||t.some((n,s)=>!Object.is(n,r[s]))}function p({children:t,intervalMs:r}){const[n,s]=c.useState(0);return c.useEffect(()=>{if(n===0)return;const l=setTimeout(()=>s(i=>i+1),r);return()=>clearTimeout(l)},[n,r]),e.jsx(K,{fallbackRender:()=>e.jsxs("div",{children:["Something went wrong. Retrying in ",r/6e4," minutes..."]}),onReset:()=>s(l=>l+1),resetKeys:[n],children:t})}function V(){return e.jsx(E,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-4 p-4",children:[e.jsx(J,{}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-5xl text-primary-foreground",children:new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:new Date().toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsx("div",{className:"w-1/4",children:e.jsx(A,{})})]}),e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx("div",{className:"w-full",children:e.jsx(p,{intervalMs:1e3*60*1,children:e.jsx(H,{})})})}),e.jsx("div",{className:"flex justify-center gap-4",children:e.jsx("div",{className:"",children:e.jsxs(p,{intervalMs:1e3*60*1,children:[e.jsx("h1",{children:"Messages"}),e.jsx(P,{})]})})}),e.jsx("div",{className:"h-1/3",children:e.jsx(p,{intervalMs:1e3*60*1,children:e.jsx(L,{})})})]})})}function J(){return e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:`
        linear-gradient(to bottom,
            rgba(0, 0, 0, 0.2) 50%,
            rgba(0, 0, 0, 0) 20%,
            rgba(0, 0, 0, 0) 30%,
            rgba(0, 0, 0, .2) 50%
        )
    `}})}export{V as default};
//# sourceMappingURL=HaDashboard-CMnwKU6n.js.map
