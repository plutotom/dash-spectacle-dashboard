import{b as v,j as e,r as i,q as P,R as p}from"./app-DEbPEzRX.js";import{f as _}from"./utils-BD4OweYj.js";import{H as C,R as y}from"./HaDashboardLayout-BMmomur-.js";const T={async getEvents(){return(await v.get("/api/calendar-events")).data.data}};function I({dayEvents:t,dayDate:r}){return t.length?e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),t.map(s=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(W,{event:s})},s.id))]}):null}function W({event:t}){return t.isAllDay?e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),e.jsx("span",{children:t.summary})]})}):e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(t.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(t.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:t.summary})]})})}function k({className:t}){const[r,s]=i.useState(null),[a,l]=i.useState(!0),[o,c]=i.useState(null),[u,n]=i.useState(null);return i.useEffect(()=>{const m=async()=>{try{const f=await T.getEvents();s(f),n(new Date),c(null)}catch(f){c("Failed to fetch calendar events"),console.error(f)}finally{l(!1)}};m();const x=setInterval(m,20*60*1e3);return()=>clearInterval(x)},[]),a?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):e.jsxs("div",{className:`rounded-lg shadow-sm ${t}`,children:[e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",style:{display:"none"},children:["Last updated: ",u==null?void 0:u.toLocaleString()]}),r&&Object.keys(r||{}).length>0?Object.values(r||{}).slice(0,4).map((m,x)=>e.jsx("div",{className:"w-1/4",children:e.jsx(I,{dayEvents:m,dayDate:Object.keys(r)[x]},x)},x)):e.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})}),o&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading calendar: ",o]})]})}function M(){var f;const[t,r]=i.useState([]),[s,a]=i.useState(!0),[l,o]=i.useState(null),[c,u]=i.useState(!0),n=i.useRef(null),m=1e3*10;i.useEffect(()=>{const d=async()=>{try{const h=await v.get("/messages/feed");o(null),r(h.data.data),a(!1)}catch(h){o("Failed"+JSON.stringify(h)),a(!1)}};d();const g=setInterval(()=>{d()},1e3*60*1);return()=>clearInterval(g)},[]),i.useEffect(()=>{const d=()=>{u(!0),n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{u(!1)},m)},g=()=>d(),h=["mousemove","keydown","mousedown","touchstart","scroll"];return h.forEach(j=>window.addEventListener(j,g,{passive:!0})),d(),()=>{h.forEach(j=>window.removeEventListener(j,g)),n.current&&clearTimeout(n.current)}},[]);const x=((f=P().props.auth)==null?void 0:f.user)??!1;return e.jsxs("div",{className:"w-full",children:[s&&e.jsx("div",{children:"Loading messages..."}),e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("div",{style:{overflowY:"auto",maxHeight:"30vh",scrollbarWidth:"none",msOverflowStyle:"none"},className:"w-full",children:[e.jsx("style",{children:`
                            [data-hide-scrollbar]::-webkit-scrollbar {
                                display: none;
                            }
                        `}),e.jsx("div",{"data-hide-scrollbar":!0,children:t.length===0?!s&&e.jsx("div",{className:"text-muted-foreground",children:"No messages available"}):t.map(d=>e.jsxs("div",{className:"my-1 flex flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:d.name}),e.jsx("span",{children:new Date(d.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:d.content})]},d.id))})]})}),l&&e.jsx("div",{className:"text-red-500",children:l}),x&&e.jsxs("form",{className:`mt-2 flex gap-2 transition-opacity duration-500 ${c?"opacity-100":"pointer-events-none opacity-0"}`,onSubmit:async d=>{d.preventDefault();const g=d.target,h=new FormData(g),j=String(h.get("content")||"").trim();if(j)try{await v.post("/messages",{content:j}),g.reset();const N=await v.get("/messages/feed");r(N.data.data),o(null)}catch(N){o("Failed"+JSON.stringify(N))}},children:[e.jsx("input",{name:"content",placeholder:"Write a message...",className:"flex-1 rounded border border-gray-300 p-2 text-sm text-black",onFocus:()=>u(!0)}),e.jsx("button",{type:"submit",className:"rounded bg-blue-600 px-3 py-2 text-sm text-white",children:"Send"})]})]})}const F=({endpoint:t="/prayer-requests/dashboard",limit:r})=>{const[s,a]=i.useState([]),[l,o]=i.useState(!0),[c,u]=i.useState(null);return i.useEffect(()=>{fetch(t).then(n=>{if(!n.ok)throw new Error("Failed to fetch prayer requests");return n.json()}).then(n=>{const m=n.data||[];a(r?m.slice(0,r):m),o(!1)}).catch(n=>{u(n.message),o(!1)})},[t,r]),l?e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Loading prayer requests..."}):c?e.jsxs("div",{className:"text-red-500",children:["Error: ",c]}):e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("div",{style:{overflowY:"auto",maxHeight:"30vh",scrollbarWidth:"none",msOverflowStyle:"none"},className:"w-full",children:[e.jsx("style",{children:`
                            [data-hide-scrollbar]::-webkit-scrollbar {
                                display: none;
                            }
                        `}),e.jsx("div",{"data-hide-scrollbar":!0,children:s.length===0?!l&&e.jsx("div",{className:"text-primary-foreground opacity-70",children:"No prayer requests available"}):s.map(n=>e.jsxs("div",{className:`my-1 flex flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors ${n.is_answered?"opacity-60":""}`,children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:n.name||"Unnamed"}),e.jsx("span",{className:"text-lg",children:n.is_answered?"‚úÖ":"üôè"})]}),e.jsxs("div",{className:`text-sm text-white ${n.is_answered?"line-through":""}`,children:[n.person&&e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Person:"})," ",n.person]}),n.answer&&e.jsxs("div",{className:"mb-1 text-green-200",children:[e.jsx("span",{className:"font-medium",children:"Answer:"})," ",n.answer]})]}),e.jsxs("div",{className:"mt-1 text-xs text-gray-300",children:[n.prayer_date&&e.jsxs("span",{children:["Prayer Date: ",new Date(n.prayer_date).toLocaleDateString()]}),n.answered_at&&e.jsxs("span",{className:"ml-2",children:["Answered: ",new Date(n.answered_at).toLocaleDateString()]})]})]},n.id))})]})})})},E={async getCurrentWeather(){return(await v.get("/api/weather/current")).data.data},async getForecast(){return(await v.get("/api/weather/forecast")).data.data}};var D={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},S=p.createContext&&p.createContext(D),R=["attr","size","title"];function z(t,r){if(t==null)return{};var s=A(t,r),a,l;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(l=0;l<o.length;l++)a=o[l],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(s[a]=t[a])}return s}function A(t,r){if(t==null)return{};var s={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){if(r.indexOf(a)>=0)continue;s[a]=t[a]}return s}function b(){return b=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},b.apply(this,arguments)}function O(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),s.push.apply(s,a)}return s}function w(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?O(Object(s),!0).forEach(function(a){H(t,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):O(Object(s)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(s,a))})}return t}function H(t,r,s){return r=U(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function U(t){var r=B(t,"string");return typeof r=="symbol"?r:r+""}function B(t,r){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var a=s.call(t,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function L(t){return t&&t.map((r,s)=>p.createElement(r.tag,w({key:s},r.attr),L(r.child)))}function $(t){return r=>p.createElement(G,b({attr:w({},t.attr)},r),L(t.child))}function G(t){var r=s=>{var{attr:a,size:l,title:o}=t,c=z(t,R),u=l||s.size||"1em",n;return s.className&&(n=s.className),t.className&&(n=(n?n+" ":"")+t.className),p.createElement("svg",b({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,a,c,{className:n,style:w(w({color:t.color||s.color},s.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&p.createElement("title",null,o),t.children)};return S!==void 0?p.createElement(S.Consumer,null,s=>r(s)):r(D)}function J(t){return $({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 11c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 2c0-3.31-2.69-6-6-6s-6 2.69-6 6c0 2.22 1.21 4.15 3 5.19l1-1.74c-1.19-.7-2-1.97-2-3.45 0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.48-.81 2.75-2 3.45l1 1.74c1.79-1.04 3-2.97 3-5.19zM12 3C6.48 3 2 7.48 2 13c0 3.7 2.01 6.92 4.99 8.65l1-1.73C5.61 18.53 4 15.96 4 13c0-4.42 3.58-8 8-8s8 3.58 8 8c0 2.96-1.61 5.53-4 6.92l1 1.73c2.99-1.73 5-4.95 5-8.65 0-5.52-4.48-10-10-10z"},child:[]}]})(t)}function V(){var n,m;const[t,r]=i.useState(null),[s,a]=i.useState(!0),[l,o]=i.useState(null),[c,u]=i.useState(null);return i.useEffect(()=>{const x=async()=>{try{o(null);const d=await E.getCurrentWeather();console.log(d),r(d),u(new Date)}catch(d){o("Failed to fetch current weather"),console.error(d)}finally{a(!1)}};x();const f=setInterval(x,15*60*1e3);return()=>clearInterval(f)},[]),s?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):!t||!t.current?e.jsxs("div",{className:"h-40 w-full",children:[e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsx("div",{className:"flex h-full items-center justify-center text-primary-foreground opacity-70",children:"Weather unavailable"})}),l&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading Current Weather: ",l]})]}):e.jsxs("div",{className:"h-40 w-full",children:[e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsx("div",{className:"flex flex-row gap-1 align-middle",children:e.jsxs("h1",{className:"text-5xl",children:[((n=t==null?void 0:t.current)==null?void 0:n.home_assistant_current_temp)??"-","¬∞"]})}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[e.jsx(J,{}),e.jsxs("h3",{className:"text-base",children:[((m=t==null?void 0:t.current)==null?void 0:m.temp_f)??"-","¬∞"]})]}),e.jsx("div",{className:"text-small text-muted-foreground",children:c==null?void 0:c.toLocaleString()})]})}),l&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading Current Weather: ",l]})]})}const Y=()=>{const[t,r]=i.useState(null),[s,a]=i.useState(!0),[l,o]=i.useState(null);return i.useEffect(()=>{const c=async()=>{try{const n=await E.getForecast();r(n),o(new Date)}catch(n){console.error("Failed to load forecast:",n)}finally{a(!1)}};c();const u=setInterval(c,20*60*1e3);return()=>clearInterval(u)},[]),s?e.jsx("div",{children:"Loading forecast..."}):!t||!t.forecast?e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Forecast unavailable"}):e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:t.forecast.map(c=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:_(new Date(c.date+"T00:00:00")).replace("Next ","")}),e.jsxs("div",{children:[e.jsx("img",{src:c.day.condition.icon,alt:c.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(c.day.maxtemp_f),"¬∞"]})," / ",e.jsxs("span",{className:"",children:[Math.round(c.day.mintemp_f),"¬∞"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[c.day.daily_chance_of_rain,"%"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[l==null?void 0:l.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"})," ",l==null?void 0:l.toLocaleTimeString()]})]})]})]},c.date_epoch))})})};function ee(){const[t,r]=i.useState(!0);return i.useEffect(()=>{const s=async()=>{try{const l=await v.get("/api/settings/public");r(l.data.show_prayer_requests??!0)}catch(l){console.error("Failed to fetch settings:",l),r(!0)}};s();const a=setInterval(s,3e4);return()=>clearInterval(a)},[]),e.jsx(C,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-4 p-4",children:[e.jsx(q,{}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"text-5xl text-primary-foreground",children:e.jsx(K,{})})}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"text-5xl text-primary-foreground"})}),e.jsx("div",{className:"w-1/4",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Weather unavailable"}),children:e.jsx(V,{})})})]}),e.jsx("div",{className:"flex",children:e.jsx("div",{className:"w-full",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Forecast unavailable"}),children:e.jsx(Y,{})})})}),e.jsx("div",{className:"flex w-1/3 items-center justify-start",children:e.jsx("div",{className:"w-full",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Message unavailable"}),children:e.jsx(M,{})})})}),t&&e.jsx("div",{className:"flex w-1/3 items-center justify-start",children:e.jsx("div",{className:"w-full",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Prayer requests unavailable"}),children:e.jsx(F,{limit:8})})})}),e.jsx("div",{className:"mt-auto",children:e.jsx(y,{intervalMs:1e4,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Calendar unavailable"}),children:e.jsx(k,{})})})]})})}function q(){return e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:`
        linear-gradient(to bottom,
            rgba(0, 0, 0, 0.2) 50%,
            rgba(0, 0, 0, 0) 20%,
            rgba(0, 0, 0, 0) 30%,
            rgba(0, 0, 0, .2) 50%
        )
    `}})}function K(){const[t,r]=i.useState(new Date);return i.useEffect(()=>{r(new Date);const s=setInterval(()=>{r(new Date)},1e3*60);return()=>clearInterval(s)},[]),e.jsxs("div",{children:[e.jsx("div",{className:"text-8xl text-primary-foreground",children:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:t.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}export{ee as default};
//# sourceMappingURL=HaDashboard-D1z_lbOH.js.map
