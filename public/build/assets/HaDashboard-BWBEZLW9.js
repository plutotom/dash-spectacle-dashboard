import{b as m,j as e,r as a}from"./app-BiYkq-Kw.js";const g={async getEvents(){return(await m.get("/api/calendar-events")).data.data}};function j({dayEvents:t,dayDate:c}){return e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(t[0].start.dateTime).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",timeZone:t[0].start.timeZone})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),t.map(r=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(v,{event:r})},r.id))]})}function v({event:t}){return e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(t.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(t.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:t.summary})]})})}function p({className:t}){const[c,r]=a.useState(null),[l,i]=a.useState(!0),[o,s]=a.useState(null),[d,n]=a.useState(null);return a.useEffect(()=>{const x=async()=>{try{const h=await g.getEvents();r(h),n(new Date)}catch(h){s("Failed to fetch calendar events"),console.error(h)}finally{i(!1)}};x();const u=setInterval(x,20*60*1e3);return()=>clearInterval(u)},[]),l?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):o?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading calendar: ",o]}):e.jsx("div",{className:`rounded-lg shadow-sm ${t}`,children:e.jsx("div",{children:e.jsx("div",{className:"flex space-x-2",children:Object.values(c).slice(0,3).map((x,u)=>e.jsx("div",{className:"w-1/4",children:e.jsx(j,{dayEvents:x,dayDate:Object.keys(c)[u]},u)},u))})})})}function y(){const[t,c]=a.useState([]),[r,l]=a.useState(!0),[i,o]=a.useState(null);return a.useEffect(()=>{const s=async()=>{try{const n=await m.get("/api/messages");c(n.data.data),l(!1)}catch{o("Failed to load messages"),l(!1)}};s();const d=setInterval(()=>{s()},1e3*60*1);return()=>clearInterval(d)},[]),r?e.jsx("div",{children:"Loading messages..."}):i?e.jsx("div",{className:"text-red-500",children:i}):e.jsx("div",{className:"",children:e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",children:t.map(s=>e.jsxs("div",{className:"my-1 flex w-1/3 flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:s.name}),e.jsx("span",{children:new Date(s.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:s.content})]},s.id))})})}const f={async getCurrentWeather(){return(await m.get("/api/weather/current")).data.data},async getForecast(){return(await m.get("/api/weather/forecast")).data.data}};function N(){const[t,c]=a.useState(null),[r,l]=a.useState(!0),[i,o]=a.useState(null),[s,d]=a.useState(null);return a.useEffect(()=>{const n=async()=>{try{const u=await f.getCurrentWeather();c(u),d(new Date)}catch(u){o("Failed to fetch current weather"),console.error(u)}finally{l(!1)}};n();const x=setInterval(n,15*60*1e3);return()=>clearInterval(x)},[]),r?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):i?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading weather: ",i]}):e.jsx("div",{className:"",children:e.jsx("div",{className:"inline-block rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsxs("div",{className:"flex items-end",children:[e.jsxs("h1",{className:"text-5xl",children:[t==null?void 0:t.current.temp_f,"째"]}),e.jsx("span",{className:"ml-2 pr-1 text-base",children:"But Feels like"}),e.jsxs("h1",{className:"text-xl",children:[t.current.feelslike_f,"째"]})]}),e.jsxs("div",{className:"text-base",children:["Wind: ",t.current.wind_dir," ",t.current.wind_mph,"MPH"]})]})})})}function b(t){const c=new Date;c.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const l=(r.getTime()-c.getTime())/(1e3*60*60*24);return l===0?"Today":l===1?"Tomorrow":l<7&&l>1?`Next ${r.toLocaleDateString(void 0,{weekday:"long"})}`:r.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}const w=()=>{const[t,c]=a.useState(null),[r,l]=a.useState(!0),[i,o]=a.useState(null);return a.useEffect(()=>{const s=async()=>{try{const n=await f.getForecast();c(n),o(new Date)}catch(n){console.error("Failed to load forecast:",n)}finally{l(!1)}};s();const d=setInterval(s,20*60*1e3);return()=>clearInterval(d)},[]),r?e.jsx("div",{children:"Loading forecast..."}):t?e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:t.forecast.map(s=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:b(new Date(s.date))}),e.jsxs("div",{children:[e.jsx("img",{src:s.day.condition.icon,alt:s.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(s.day.maxtemp_f),"째"]})," / ",e.jsxs("span",{className:"",children:[Math.round(s.day.mintemp_f),"째"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[s.day.daily_chance_of_rain,"%"]})]})]})]},s.date_epoch))})}):e.jsx("div",{children:"Unable to load forecast"})},S=!1;function D({children:t}){const[c,r]=a.useState(null),[l,i]=a.useState(!1),[o,s]=a.useState(!0),d=async()=>{try{const n=await m.get("/api/random-photo-from-dashboard-album");n.status===200&&(r(n.data.url),i(!1))}catch(n){console.error("Failed to fetch photo:",n),i(!0)}finally{s(!1)}};return a.useEffect(()=>{d();const n=setInterval(d,1e3*60*10);return()=>clearInterval(n)},[]),o?e.jsx("div",{children:"Loading..."}):e.jsx("div",{children:e.jsx("div",{className:"min-h-screen bg-gray-900",style:{backgroundImage:`url(${c})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",transition:"background-image 1s ease-in-out"},children:e.jsx(L,{children:t})})})}function L({children:t}){return e.jsx("div",{className:"",style:{background:`
        linear-gradient(to bottom,
            rgba(0, 0, 0, 0.2) 50%,
            rgba(0, 0, 0, 0) 20%,
            rgba(0, 0, 0, 0) 30%,
            rgba(0, 0, 0, .2) 50%
        )
    `},children:t})}function k({children:t}){return e.jsx(e.Fragment,{children:e.jsx(D,{children:e.jsx("div",{className:"relative",children:e.jsx("main",{children:t})})})})}function I(){const[t,c]=a.useState(new Date);return a.useEffect(()=>{c(new Date);const r=setInterval(()=>{c(new Date)},1e3*6);return()=>clearInterval(r)},[]),e.jsx(k,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-1 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-8xl text-primary-foreground",children:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:t.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsx("div",{className:"w-1/4",children:e.jsx(N,{})})]}),e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx("div",{className:"w-full",children:e.jsx(w,{})})}),e.jsx("div",{className:"flex gap-4",children:e.jsx("div",{className:"w-full max-w-7xl",children:e.jsx(y,{})})}),e.jsx("div",{className:"h-1/3",children:e.jsx(p,{})})]})})}export{I as default};
