import{b as m,j as e,r as a}from"./app-CYPL2uMF.js";import{H as j}from"./HaDashboardLayout-DuHZwGRt.js";const g={async getEvents(){return(await m.get("/api/calendar-events")).data.data}};function v({dayEvents:t,dayDate:r}){return t.length?e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),t.map(n=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(p,{event:n})},n.id))]}):null}function p({event:t}){return t.isAllDay?e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),e.jsx("span",{children:t.summary})]})}):e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(t.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(t.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:t.summary})]})})}function N({className:t}){const[r,n]=a.useState(null),[l,x]=a.useState(!0),[i,s]=a.useState(null),[d,c]=a.useState(null);return a.useEffect(()=>{const u=async()=>{try{const h=await g.getEvents();n(h),c(new Date)}catch(h){s("Failed to fetch calendar events"),console.error(h)}finally{x(!1)}};u();const o=setInterval(u,20*60*1e3);return()=>clearInterval(o)},[]),l?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):i?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading calendar: ",i]}):e.jsx("div",{className:`rounded-lg shadow-sm ${t}`,children:e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Last updated: ",d==null?void 0:d.toLocaleString()]}),r&&Object.keys(r).length>0?Object.values(r).slice(0,4).map((u,o)=>e.jsx("div",{className:"w-1/4",children:e.jsx(v,{dayEvents:u,dayDate:Object.keys(r)[o]},o)},o)):e.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})})})}function y(){const[t,r]=a.useState([]),[n,l]=a.useState(!0),[x,i]=a.useState(null);return a.useEffect(()=>{const s=async()=>{try{const c=await m.get("/api/messages");i(null),r(c.data.data),l(!1)}catch(c){i("Failed"+JSON.stringify(c)),l(!1)}};s();const d=setInterval(()=>{s()},1e3*60*1);return()=>clearInterval(d)},[]),n?e.jsx("div",{children:"Loading messages..."}):x?e.jsx("div",{className:"text-red-500",children:x}):e.jsx("div",{className:"",children:e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",children:t.map(s=>e.jsxs("div",{className:"my-1 flex w-1/3 flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:s.name}),e.jsx("span",{children:new Date(s.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:s.content})]},s.id))})})}const f={async getCurrentWeather(){return(await m.get("/api/weather/current")).data.data},async getForecast(){return(await m.get("/api/weather/forecast")).data.data}};function w(){const[t,r]=a.useState(null),[n,l]=a.useState(!0),[x,i]=a.useState(null),[s,d]=a.useState(null);return a.useEffect(()=>{const c=async()=>{try{i(null);const o=await f.getCurrentWeather();r(o),d(new Date)}catch(o){i("Failed to fetch current weather"),console.error(o)}finally{l(!1)}};c();const u=setInterval(c,15*60*1e3);return()=>clearInterval(u)},[]),n?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):x?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading weather: ",x]}):e.jsx("div",{className:"h-40 w-full",children:e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsx("div",{className:"flex items-end",children:e.jsxs("h1",{className:"text-5xl",children:[t==null?void 0:t.current.temp_f,"째"]})}),e.jsx("div",{className:"flex items-center",children:e.jsxs("h3",{className:"text-base",children:["Feels Like: ",t.current.feelslike_f,"째"]})}),e.jsx("div",{className:"text-small text-muted-foreground",children:s==null?void 0:s.toLocaleString()})]})})})}function S(t){const r=new Date;r.setHours(0,0,0,0);const n=new Date(t);n.setHours(0,0,0,0);const l=(n.getTime()-r.getTime())/(1e3*60*60*24);return l===0?"Today":l===1?"Tomorrow":l<7&&l>1?`Next ${n.toLocaleDateString(void 0,{weekday:"long"})}`:n.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}const b=()=>{const[t,r]=a.useState(null),[n,l]=a.useState(!0),[x,i]=a.useState(null);return a.useEffect(()=>{const s=async()=>{try{const c=await f.getForecast();r(c),i(new Date)}catch(c){console.error("Failed to load forecast:",c)}finally{l(!1)}};s();const d=setInterval(s,20*60*1e3);return()=>clearInterval(d)},[]),n?e.jsx("div",{children:"Loading forecast..."}):t?e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:t.forecast.map(s=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:S(new Date(s.date+"T00:00:00")).replace("Next ","")}),e.jsxs("div",{children:[e.jsx("img",{src:s.day.condition.icon,alt:s.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(s.day.maxtemp_f),"째"]})," / ",e.jsxs("span",{className:"",children:[Math.round(s.day.mintemp_f),"째"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[s.day.daily_chance_of_rain,"%"]})]})]})]},s.date_epoch))})}):e.jsx("div",{children:"Unable to load forecast"})};function T(){return e.jsx(j,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-1 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(D,{})}),e.jsx("div",{className:"h-40 w-1/3 justify-end",children:e.jsx("div",{className:"flex items-center",children:e.jsx(w,{})})})]}),e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx("div",{className:"w-full",children:e.jsx(b,{})})}),e.jsx("div",{className:"flex gap-4",children:e.jsx("div",{className:"w-full max-w-7xl",children:e.jsx(y,{})})}),e.jsx("div",{className:"h-1/3",children:e.jsx(N,{})})]})})}function D(){const[t,r]=a.useState(new Date);return a.useEffect(()=>{r(new Date);const n=setInterval(()=>{r(new Date)},1e3*60);return()=>clearInterval(n)},[]),e.jsxs("div",{children:[e.jsx("div",{className:"text-8xl text-primary-foreground",children:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:t.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}export{T as default};
//# sourceMappingURL=HaDashboard-BZ72_yX_.js.map
