import{b as v,j as e,r as l,R as h}from"./app-BdzYMFUb.js";import{H as E,R as p}from"./HaDashboardLayout-7A2AksW_.js";const L={async getEvents(){return(await v.get("/api/calendar-events")).data.data}};function T({dayEvents:t,dayDate:r}){return t.length?e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),t.map(a=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(C,{event:a})},a.id))]}):null}function C({event:t}){return t.isAllDay?e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),e.jsx("span",{children:t.summary})]})}):e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(t.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(t.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:t.summary})]})})}function P({className:t}){const[r,a]=l.useState(null),[s,n]=l.useState(!0),[d,c]=l.useState(null),[u,o]=l.useState(null);return l.useEffect(()=>{const f=async()=>{try{const m=await L.getEvents();a(m),o(new Date),c(null)}catch(m){c("Failed to fetch calendar events"),console.error(m)}finally{n(!1)}};f();const i=setInterval(f,20*60*1e3);return()=>clearInterval(i)},[]),s?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):e.jsxs("div",{className:`rounded-lg shadow-sm ${t}`,children:[e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",style:{display:"none"},children:["Last updated: ",u==null?void 0:u.toLocaleString()]}),r&&Object.keys(r||{}).length>0?Object.values(r||{}).slice(0,4).map((f,i)=>e.jsx("div",{className:"w-1/4",children:e.jsx(T,{dayEvents:f,dayDate:Object.keys(r)[i]},i)},i)):e.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})}),d&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading calendar: ",d]})]})}function _(){const[t,r]=l.useState([]),[a,s]=l.useState(!0),[n,d]=l.useState(null),[c,u]=l.useState(!0),o=l.useRef(null),f=1e3*10;return l.useEffect(()=>{const i=async()=>{try{const x=await v.get("/messages/feed");d(null),r(x.data.data),s(!1)}catch(x){d("Failed"+JSON.stringify(x)),s(!1)}};i();const m=setInterval(()=>{i()},1e3*60*1);return()=>clearInterval(m)},[]),l.useEffect(()=>{const i=()=>{u(!0),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{u(!1)},f)},m=()=>i(),x=["mousemove","keydown","mousedown","touchstart","scroll"];return x.forEach(g=>window.addEventListener(g,m,{passive:!0})),i(),()=>{x.forEach(g=>window.removeEventListener(g,m)),o.current&&clearTimeout(o.current)}},[]),e.jsxs("div",{className:"w-full",children:[a&&e.jsx("div",{children:"Loading messages..."}),e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("div",{style:{overflowY:"auto",maxHeight:"30vh",scrollbarWidth:"none",msOverflowStyle:"none"},className:"w-full",children:[e.jsx("style",{children:`
                            [data-hide-scrollbar]::-webkit-scrollbar {
                                display: none;
                            }
                        `}),e.jsx("div",{"data-hide-scrollbar":!0,children:t.length===0?!a&&e.jsx("div",{className:"text-muted-foreground",children:"No messages available"}):t.map(i=>e.jsxs("div",{className:"my-1 flex flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:i.name}),e.jsx("span",{children:new Date(i.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:i.content})]},i.id))})]})}),n&&e.jsx("div",{className:"text-red-500",children:n}),e.jsxs("form",{className:`mt-2 flex gap-2 transition-opacity duration-500 ${c?"opacity-100":"pointer-events-none opacity-0"}`,onSubmit:async i=>{i.preventDefault();const m=i.target,x=new FormData(m),g=String(x.get("content")||"").trim();if(g)try{await v.post("/messages",{content:g}),m.reset();const b=await v.get("/messages/feed");r(b.data.data),d(null)}catch(b){d("Failed"+JSON.stringify(b))}},children:[e.jsx("input",{name:"content",placeholder:"Write a message...",className:"flex-1 rounded border border-gray-300 p-2 text-sm text-black",onFocus:()=>u(!0)}),e.jsx("button",{type:"submit",className:"rounded bg-blue-600 px-3 py-2 text-sm text-white",children:"Send"})]})]})}const S={async getCurrentWeather(){return(await v.get("/api/weather/current")).data.data},async getForecast(){return(await v.get("/api/weather/forecast")).data.data}};var O={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},N=h.createContext&&h.createContext(O),I=["attr","size","title"];function W(t,r){if(t==null)return{};var a=k(t,r),s,n;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(n=0;n<d.length;n++)s=d[n],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(a[s]=t[s])}return a}function k(t,r){if(t==null)return{};var a={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(r.indexOf(s)>=0)continue;a[s]=t[s]}return a}function j(){return j=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},j.apply(this,arguments)}function w(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);r&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,s)}return a}function y(t){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?w(Object(a),!0).forEach(function(s){M(t,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(a,s))})}return t}function M(t,r,a){return r=F(r),r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function F(t){var r=H(t,"string");return typeof r=="symbol"?r:r+""}function H(t,r){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var s=a.call(t,r||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function D(t){return t&&t.map((r,a)=>h.createElement(r.tag,y({key:a},r.attr),D(r.child)))}function z(t){return r=>h.createElement(R,j({attr:y({},t.attr)},r),D(t.child))}function R(t){var r=a=>{var{attr:s,size:n,title:d}=t,c=W(t,I),u=n||a.size||"1em",o;return a.className&&(o=a.className),t.className&&(o=(o?o+" ":"")+t.className),h.createElement("svg",j({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,s,c,{className:o,style:y(y({color:t.color||a.color},a.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),d&&h.createElement("title",null,d),t.children)};return N!==void 0?h.createElement(N.Consumer,null,a=>r(a)):r(O)}function A(t){return z({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 11c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 2c0-3.31-2.69-6-6-6s-6 2.69-6 6c0 2.22 1.21 4.15 3 5.19l1-1.74c-1.19-.7-2-1.97-2-3.45 0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.48-.81 2.75-2 3.45l1 1.74c1.79-1.04 3-2.97 3-5.19zM12 3C6.48 3 2 7.48 2 13c0 3.7 2.01 6.92 4.99 8.65l1-1.73C5.61 18.53 4 15.96 4 13c0-4.42 3.58-8 8-8s8 3.58 8 8c0 2.96-1.61 5.53-4 6.92l1 1.73c2.99-1.73 5-4.95 5-8.65 0-5.52-4.48-10-10-10z"},child:[]}]})(t)}function U(){var o,f;const[t,r]=l.useState(null),[a,s]=l.useState(!0),[n,d]=l.useState(null),[c,u]=l.useState(null);return l.useEffect(()=>{const i=async()=>{try{d(null);const x=await S.getCurrentWeather();console.log(x),r(x),u(new Date)}catch(x){d("Failed to fetch current weather"),console.error(x)}finally{s(!1)}};i();const m=setInterval(i,15*60*1e3);return()=>clearInterval(m)},[]),a?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):!t||!t.current?e.jsxs("div",{className:"h-40 w-full",children:[e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsx("div",{className:"flex h-full items-center justify-center text-primary-foreground opacity-70",children:"Weather unavailable"})}),n&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading Current Weather: ",n]})]}):e.jsxs("div",{className:"h-40 w-full",children:[e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsx("div",{className:"flex flex-row gap-1 align-middle",children:e.jsxs("h1",{className:"text-5xl",children:[((o=t==null?void 0:t.current)==null?void 0:o.home_assistant_current_temp)??"-","째"]})}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[e.jsx(A,{}),e.jsxs("h3",{className:"text-base",children:[((f=t==null?void 0:t.current)==null?void 0:f.temp_f)??"-","째"]})]}),e.jsx("div",{className:"text-small text-muted-foreground",children:c==null?void 0:c.toLocaleString()})]})}),n&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading Current Weather: ",n]})]})}function B(t){const r=new Date;r.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const s=(a.getTime()-r.getTime())/(1e3*60*60*24);return s===0?"Today":s===1?"Tomorrow":s<7&&s>1?`Next ${a.toLocaleDateString(void 0,{weekday:"long"})}`:a.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}const $=()=>{const[t,r]=l.useState(null),[a,s]=l.useState(!0),[n,d]=l.useState(null);return l.useEffect(()=>{const c=async()=>{try{const o=await S.getForecast();r(o),d(new Date)}catch(o){console.error("Failed to load forecast:",o)}finally{s(!1)}};c();const u=setInterval(c,20*60*1e3);return()=>clearInterval(u)},[]),a?e.jsx("div",{children:"Loading forecast..."}):!t||!t.forecast?e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Forecast unavailable"}):e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:t.forecast.map(c=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:B(new Date(c.date+"T00:00:00")).replace("Next ","")}),e.jsxs("div",{children:[e.jsx("img",{src:c.day.condition.icon,alt:c.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(c.day.maxtemp_f),"째"]})," / ",e.jsxs("span",{className:"",children:[Math.round(c.day.mintemp_f),"째"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[c.day.daily_chance_of_rain,"%"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n==null?void 0:n.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"})," ",n==null?void 0:n.toLocaleTimeString()]})]})]})]},c.date_epoch))})})};function Y(){return e.jsx(E,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-4 p-4",children:[e.jsx(G,{}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"text-5xl text-primary-foreground",children:e.jsx(J,{})})}),e.jsx("div",{className:"w-1/4",children:e.jsx(p,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Weather unavailable"}),children:e.jsx(U,{})})})]}),e.jsx("div",{className:"flex",children:e.jsx("div",{className:"w-full",children:e.jsx(p,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Forecast unavailable"}),children:e.jsx($,{})})})}),e.jsx("div",{className:"flex w-1/3 items-center justify-start",children:e.jsx("div",{className:"w-full",children:e.jsx(p,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Message unavailable"}),children:e.jsx(_,{})})})}),e.jsx("div",{className:"mt-auto",children:e.jsx(p,{intervalMs:1e4,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Calendar unavailable"}),children:e.jsx(P,{})})})]})})}function G(){return e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:`
        linear-gradient(to bottom,
            rgba(0, 0, 0, 0.2) 50%,
            rgba(0, 0, 0, 0) 20%,
            rgba(0, 0, 0, 0) 30%,
            rgba(0, 0, 0, .2) 50%
        )
    `}})}function J(){const[t,r]=l.useState(new Date);return l.useEffect(()=>{r(new Date);const a=setInterval(()=>{r(new Date)},1e3*60);return()=>clearInterval(a)},[]),e.jsxs("div",{children:[e.jsx("div",{className:"text-8xl text-primary-foreground",children:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:t.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}export{Y as default};
//# sourceMappingURL=HaDashboard-BfrvVer3.js.map
