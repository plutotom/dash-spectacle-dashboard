import{r as s,b as E,j as e,y as I}from"./app-ieQgo3w9.js";const X=({albums:i,errors:o,success:n})=>{var C;console.log(i),console.log(o),console.log(n);const[p,k]=s.useState(((C=i[0])==null?void 0:C.id)||""),[b,F]=s.useState(null),[c,m]=s.useState(null),[f,L]=s.useState(null),[t,j]=s.useState("google"),[u,N]=s.useState(""),[y,g]=s.useState(null),[v,R]=s.useState(null),[S,w]=s.useState([]),[P,x]=s.useState(!1),[A,h]=s.useState(null);s.useEffect(()=>{t==="local"&&(x(!0),E.get("/api/local-images",{withCredentials:!0}).then(l=>{w(l.data.images||[]),x(!1)}).catch(()=>x(!1)))},[t]);const U=l=>{var a;h(null),console.log("deleting image",l),E.delete(`/api/local-images/${encodeURIComponent(l)}`,{headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.content)||""}}).then(d=>{d.data.success?w(r=>r.filter(q=>q.filename!==l)):h(d.data.error||"Failed to delete image")}).catch(()=>h("Failed to delete image"))},D=l=>{if(l.preventDefault(),!u.trim()){g("Album name is required");return}g(null),I.post("/api/create-album",{name:u},{onSuccess:()=>{N(""),R("Album created! Reloading..."),setTimeout(()=>window.location.reload(),1e3)},onError:a=>{g((a==null?void 0:a.name)||"Failed to create album")}})},T=l=>{if(l.preventDefault(),!b)return;const a={...t==="google"&&{albumId:p},photos:Array.from(b)},d=t==="google"?"/api/upload-photos":"/api/upload-photos-local";I.post(d,a,{forceFormData:!0,onProgress:r=>{m(r.percentage)},onSuccess:r=>{L(r.props.results),m(null)},onError:()=>{m(null)}})};return e.jsxs("div",{className:"mx-auto max-w-2xl space-y-8 p-6",children:[e.jsxs("form",{onSubmit:D,className:"mb-8 rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[e.jsx("h2",{className:"mb-2 text-lg font-semibold text-gray-800",children:"Create a New Album"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:u,onChange:l=>N(l.target.value),placeholder:"Album name",className:"flex-1 rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-blue-500"}),e.jsx("button",{type:"submit",className:"rounded-md bg-green-600 px-4 py-2 text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:"Create Album"})]}),y&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:y}),v&&e.jsx("div",{className:"mt-2 text-sm text-green-600",children:v}),(o==null?void 0:o.album_error)&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:o.album_error}),n&&e.jsx("div",{className:"mt-2 text-sm text-green-600",children:n})]}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[o&&Object.values(o).map(l=>e.jsx("div",{className:"mb-4 rounded-lg bg-red-100 p-4 text-red-700",children:l},l)),n&&e.jsx("div",{className:"mb-4 rounded-lg bg-green-100 p-4 text-green-700",children:n}),e.jsx("h1",{className:"mb-6 text-2xl font-bold text-gray-800",children:"Upload Photos"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Upload Type:"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"google",checked:t==="google",onChange:l=>j(l.target.value),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"Google Photos"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"local",checked:t==="local",onChange:l=>j(l.target.value),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"Local Storage"})]})]})]}),t==="google"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"album-select",className:"block text-sm font-medium text-gray-700",children:"Select Album:"}),e.jsx("select",{id:"album-select",name:"album",value:p,onChange:l=>k(l.target.value),className:"w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-blue-500",children:i.map(l=>e.jsxs("option",{value:l.id,children:[l.title," (",l.mediaItemsCount||0," items)"]},l.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"file-input",className:"block text-sm font-medium text-gray-700",children:"Select Photos:"}),e.jsx("input",{id:"file-input",type:"file",multiple:!0,accept:"image/*",onChange:l=>F(l.target.files),className:"w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("button",{type:"submit",className:"w-full rounded-md bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:["Upload to ",t==="google"?"Google Photos":"Local Storage"]}),c!==null&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("progress",{value:c,max:100,className:"h-2 w-full rounded-full bg-gray-200",children:[c,"%"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[c,"%"]})]}),f&&e.jsxs("div",{className:"mt-6 rounded-lg bg-gray-50 p-4",children:[e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-800",children:"Upload Results"}),e.jsx("pre",{className:"overflow-x-auto text-sm text-gray-600",children:JSON.stringify(f,null,2)})]})]}),t==="local"&&e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-800",children:"Local Images"}),P?e.jsx("div",{children:"Loading images..."}):S.length===0?e.jsx("div",{className:"text-gray-500",children:"No local images found."}):e.jsx("div",{className:"grid grid-cols-2 gap-4",children:S.map(l=>e.jsxs("div",{className:"relative rounded border bg-white p-2 shadow",children:[e.jsx("img",{src:l.url,alt:l.filename,className:"h-40 w-full rounded object-cover"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("span",{className:"break-all text-xs",children:l.filename}),e.jsx("button",{type:"button",onClick:()=>U(l.filename),className:"ml-2 rounded bg-red-600 px-2 py-1 text-xs text-white hover:bg-red-700",children:"Delete"})]})]},l.filename))}),A&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:A})]})]})};export{X as default};
//# sourceMappingURL=UploadPhotos-BjddE5_N.js.map
