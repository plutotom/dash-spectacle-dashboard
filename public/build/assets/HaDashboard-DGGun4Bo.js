import{b as x,j as e,r as c,R as m}from"./app-TYR3tU8e.js";import{H as E}from"./HaDashboardLayout-BTccskSn.js";const D={async getEvents(){return(await x.get("/api/calendar-events")).data.data}};function O({dayEvents:t,dayDate:r}){return t.length?e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),t.map(a=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(C,{event:a})},a.id))]}):null}function C({event:t}){return t.isAllDay?e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),e.jsx("span",{children:t.summary})]})}):e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(t.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(t.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:t.summary})]})})}function L({className:t}){const[r,a]=c.useState(null),[n,l]=c.useState(!0),[i,s]=c.useState(null),[d,o]=c.useState(null);return c.useEffect(()=>{const f=async()=>{try{const j=await D.getEvents();a(j),o(new Date)}catch(j){s("Failed to fetch calendar events"),console.error(j)}finally{l(!1)}};f();const u=setInterval(f,20*60*1e3);return()=>clearInterval(u)},[]),n?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):i?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading calendar: ",i]}):e.jsx("div",{className:`rounded-lg shadow-sm ${t}`,children:e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",style:{display:"none"},children:["Last updated: ",d==null?void 0:d.toLocaleString()]}),r&&Object.keys(r).length>0?Object.values(r).slice(0,4).map((f,u)=>e.jsx("div",{className:"w-1/4",children:e.jsx(O,{dayEvents:f,dayDate:Object.keys(r)[u]},u)},u)):e.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})})})}function P(){const[t,r]=c.useState([]),[a,n]=c.useState(!0),[l,i]=c.useState(null);return c.useEffect(()=>{const s=async()=>{try{const o=await x.get("/api/messages");i(null),r(o.data.data),n(!1)}catch(o){i("Failed"+JSON.stringify(o)),n(!1)}};s();const d=setInterval(()=>{s()},1e3*60*1);return()=>clearInterval(d)},[]),a?e.jsx("div",{children:"Loading messages..."}):l?e.jsx("div",{className:"text-red-500",children:l}):e.jsx("div",{className:"",children:e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",children:t.map(s=>e.jsxs("div",{className:"my-1 flex w-1/3 flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:s.name}),e.jsx("span",{children:new Date(s.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:s.content})]},s.id))})})}const w={async getCurrentWeather(){return(await x.get("/api/weather/current")).data.data},async getForecast(){return(await x.get("/api/weather/forecast")).data.data}};var N={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},y=m.createContext&&m.createContext(N),T=["attr","size","title"];function I(t,r){if(t==null)return{};var a=k(t,r),n,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(l=0;l<i.length;l++)n=i[l],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function k(t,r){if(t==null)return{};var a={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;a[n]=t[n]}return a}function g(){return g=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},g.apply(this,arguments)}function b(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,n)}return a}function v(t){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?b(Object(a),!0).forEach(function(n){B(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function B(t,r,a){return r=F(r),r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function F(t){var r=M(t,"string");return typeof r=="symbol"?r:r+""}function M(t,r){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var n=a.call(t,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function S(t){return t&&t.map((r,a)=>m.createElement(r.tag,v({key:a},r.attr),S(r.child)))}function W(t){return r=>m.createElement(_,g({attr:v({},t.attr)},r),S(t.child))}function _(t){var r=a=>{var{attr:n,size:l,title:i}=t,s=I(t,T),d=l||a.size||"1em",o;return a.className&&(o=a.className),t.className&&(o=(o?o+" ":"")+t.className),m.createElement("svg",g({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,n,s,{className:o,style:v(v({color:t.color||a.color},a.style),t.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),i&&m.createElement("title",null,i),t.children)};return y!==void 0?m.createElement(y.Consumer,null,a=>r(a)):r(N)}function U(t){return W({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 11c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 2c0-3.31-2.69-6-6-6s-6 2.69-6 6c0 2.22 1.21 4.15 3 5.19l1-1.74c-1.19-.7-2-1.97-2-3.45 0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.48-.81 2.75-2 3.45l1 1.74c1.79-1.04 3-2.97 3-5.19zM12 3C6.48 3 2 7.48 2 13c0 3.7 2.01 6.92 4.99 8.65l1-1.73C5.61 18.53 4 15.96 4 13c0-4.42 3.58-8 8-8s8 3.58 8 8c0 2.96-1.61 5.53-4 6.92l1 1.73c2.99-1.73 5-4.95 5-8.65 0-5.52-4.48-10-10-10z"},child:[]}]})(t)}function z(){const[t,r]=c.useState(null),[a,n]=c.useState(!0),[l,i]=c.useState(null),[s,d]=c.useState(null);return c.useEffect(()=>{const o=async()=>{try{i(null);const u=await w.getCurrentWeather();console.log(u),r(u),d(new Date)}catch(u){i("Failed to fetch current weather"),console.error(u)}finally{n(!1)}};o();const f=setInterval(o,15*60*1e3);return()=>clearInterval(f)},[]),a?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):l?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading weather: ",l]}):e.jsx("div",{className:"h-40 w-full",children:e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsx("div",{className:"flex flex-row gap-1 align-middle",children:e.jsxs("h1",{className:"text-5xl",children:[t==null?void 0:t.current.home_assistant_current_temp,"째"]})}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[e.jsx(U,{}),e.jsxs("h3",{className:"text-base",children:[t.current.temp_f,"째"]})]}),e.jsx("div",{className:"text-small text-muted-foreground",children:s==null?void 0:s.toLocaleString()})]})})})}function A(t){const r=new Date;r.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const n=(a.getTime()-r.getTime())/(1e3*60*60*24);return n===0?"Today":n===1?"Tomorrow":n<7&&n>1?`Next ${a.toLocaleDateString(void 0,{weekday:"long"})}`:a.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}const H=()=>{const[t,r]=c.useState(null),[a,n]=c.useState(!0),[l,i]=c.useState(null);return c.useEffect(()=>{const s=async()=>{try{const o=await w.getForecast();r(o),i(new Date)}catch(o){console.error("Failed to load forecast:",o)}finally{n(!1)}};s();const d=setInterval(s,20*60*1e3);return()=>clearInterval(d)},[]),a?e.jsx("div",{children:"Loading forecast..."}):t?e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:t.forecast.map(s=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:A(new Date(s.date+"T00:00:00")).replace("Next ","")}),e.jsxs("div",{children:[e.jsx("img",{src:s.day.condition.icon,alt:s.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(s.day.maxtemp_f),"째"]})," / ",e.jsxs("span",{className:"",children:[Math.round(s.day.mintemp_f),"째"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[s.day.daily_chance_of_rain,"%"]})]})]})]},s.date_epoch))})}):e.jsx("div",{children:"Unable to load forecast"})},K=c.createContext(null),p={didCatch:!1,error:null};class h extends c.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=p}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var a,n,l=arguments.length,i=new Array(l),s=0;s<l;s++)i[s]=arguments[s];(a=(n=this.props).onReset)===null||a===void 0||a.call(n,{args:i,reason:"imperative-api"}),this.setState(p)}}componentDidCatch(r,a){var n,l;(n=(l=this.props).onError)===null||n===void 0||n.call(l,r,a)}componentDidUpdate(r,a){const{didCatch:n}=this.state,{resetKeys:l}=this.props;if(n&&a.error!==null&&R(r.resetKeys,l)){var i,s;(i=(s=this.props).onReset)===null||i===void 0||i.call(s,{next:l,prev:r.resetKeys,reason:"keys"}),this.setState(p)}}render(){const{children:r,fallbackRender:a,FallbackComponent:n,fallback:l}=this.props,{didCatch:i,error:s}=this.state;let d=r;if(i){const o={error:s,resetErrorBoundary:this.resetErrorBoundary};if(typeof a=="function")d=a(o);else if(n)d=c.createElement(n,o);else if(l!==void 0)d=l;else throw s}return c.createElement(K.Provider,{value:{didCatch:i,error:s,resetErrorBoundary:this.resetErrorBoundary}},d)}}function R(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==r.length||t.some((a,n)=>!Object.is(a,r[n]))}function Q(){return e.jsx(E,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-1 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(G,{})}),e.jsx("div",{className:"h-40 w-1/3 justify-end",children:e.jsx("div",{className:"flex items-center",children:e.jsx(h,{fallback:e.jsx("div",{children:"Error loading current weather"}),children:e.jsx(z,{})})})})]}),e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx("div",{className:"w-full",children:e.jsx(h,{fallback:e.jsx("div",{children:"Error loading forecast weather"}),children:e.jsx(H,{})})})}),e.jsx("div",{className:"flex gap-4",children:e.jsx("div",{className:"w-full max-w-7xl",children:e.jsx(h,{fallback:e.jsx("div",{children:"Error loading custom messages"}),children:e.jsx(P,{})})})}),e.jsx("div",{className:"h-1/3",children:e.jsx(h,{fallback:e.jsx("div",{children:"Error loading calendar"}),children:e.jsx(L,{})})})]})})}function G(){const[t,r]=c.useState(new Date);return c.useEffect(()=>{r(new Date);const a=setInterval(()=>{r(new Date)},1e3*60);return()=>clearInterval(a)},[]),e.jsxs("div",{children:[e.jsx("div",{className:"text-8xl text-primary-foreground",children:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:t.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}export{Q as default};
//# sourceMappingURL=HaDashboard-DGGun4Bo.js.map
