import{r as t,b as y,j as e,Y as F,y as L}from"./app-A2TJbHfK.js";import{A as R}from"./AuthenticatedLayout-BXF3gkFi.js";import"./ApplicationLogo-B64imF4R.js";import"./transition-ClW5JsDH.js";const T=({albums:c,errors:N,success:d})=>{var j;console.log(c),console.log(N),console.log(d);const[g,v]=t.useState(((j=c[0])==null?void 0:j.id)||""),[x,S]=t.useState(null),[o,i]=t.useState(null),[h,w]=t.useState(null),[l,k]=t.useState("local");t.useState(""),t.useState(null),t.useState(null);const[p,f]=t.useState([]),[I,m]=t.useState(!1),[b,u]=t.useState(null);t.useEffect(()=>{l==="local"&&(m(!0),y.get("/api/local-images",{withCredentials:!0}).then(s=>{f(s.data.images||[]),m(!1)}).catch(()=>m(!1)))},[l]);const C=s=>{var r;u(null),console.log("deleting image",s),y.delete(`/api/local-images/${encodeURIComponent(s)}`,{headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.content)||""}}).then(n=>{n.data.success?f(a=>a.filter(E=>E.filename!==s)):u(n.data.error||"Failed to delete image")}).catch(()=>u("Failed to delete image"))},D=s=>{if(s.preventDefault(),!x)return;const r={...l==="google"&&{albumId:g},photos:Array.from(x)},n=l==="google"?"/api/upload-photos":"/api/upload-photos-local";L.post(n,r,{forceFormData:!0,onProgress:a=>{i(a.percentage)},onSuccess:a=>{w(a.props.results),i(null)},onError:()=>{i(null)}})};return e.jsxs(R,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Dashboard"}),children:[e.jsx(F,{title:"Dashboard"}),e.jsxs("div",{className:"mx-auto max-w-2xl space-y-8 p-6",children:[e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[d&&e.jsx("div",{className:"mb-4 rounded-lg bg-green-100 p-4 text-green-700",children:d}),e.jsx("h1",{className:"mb-6 text-2xl font-bold text-gray-800",children:"Upload Photos"}),e.jsx("div",{className:"space-y-2"}),l==="google"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"album-select",className:"block text-sm font-medium text-gray-700",children:"Select Album:"}),e.jsx("select",{id:"album-select",name:"album",value:g,onChange:s=>v(s.target.value),className:"w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-blue-500",children:c.map(s=>e.jsxs("option",{value:s.id,children:[s.title," (",s.mediaItemsCount||0," items)"]},s.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"file-input",className:"block text-sm font-medium text-gray-700",children:"Select Photos:"}),e.jsx("input",{id:"file-input",type:"file",multiple:!0,accept:"image/*",onChange:s=>S(s.target.files),className:"w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("button",{type:"submit",className:"w-full rounded-md bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:["Upload to ",l==="google"?"Google Photos":"Local Storage"]}),o!==null&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("progress",{value:o,max:100,className:"h-2 w-full rounded-full bg-gray-200",children:[o,"%"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[o,"%"]})]}),h&&e.jsxs("div",{className:"mt-6 rounded-lg bg-gray-50 p-4",children:[e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-800",children:"Upload Results"}),e.jsx("pre",{className:"overflow-x-auto text-sm text-gray-600",children:JSON.stringify(h,null,2)})]})]}),l==="local"&&e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-800",children:"Local Images"}),I?e.jsx("div",{children:"Loading images..."}):p.length===0?e.jsx("div",{className:"text-gray-500",children:"No local images found."}):e.jsx("div",{className:"grid grid-cols-2 gap-4",children:p.map(s=>e.jsxs("div",{className:"relative rounded border bg-white p-2 shadow",children:[e.jsx("img",{src:s.url,alt:s.filename,className:"h-40 w-full rounded object-cover"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("span",{className:"break-all text-xs",children:s.filename}),e.jsx("button",{type:"button",onClick:()=>C(s.filename),className:"ml-2 rounded bg-red-600 px-2 py-1 text-xs text-white hover:bg-red-700",children:"Delete"})]})]},s.filename))}),b&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:b})]})]})]})};export{T as default};
//# sourceMappingURL=UploadPhotos-BFZLrAHR.js.map
