import{b as g,j as e,r as l,q as _,R as p}from"./app-D5oOWmzX.js";import{f as P}from"./utils-BD4OweYj.js";import{H as T,R as y}from"./HaDashboardLayout-Dq5IT-Uj.js";const I={async getEvents(){return(await g.get("/api/calendar-events")).data.data}};function C({dayEvents:t,dayDate:r}){return t.length?e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),t.map(s=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(k,{event:s})},s.id))]}):null}function k({event:t}){return t.isAllDay?e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),e.jsx("span",{children:t.summary})]})}):e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(t.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(t.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:t.summary})]})})}function W({className:t}){const[r,s]=l.useState(null),[a,n]=l.useState(!0),[u,d]=l.useState(null),[m,o]=l.useState(null);return l.useEffect(()=>{const h=async()=>{try{const x=await I.getEvents();s(x),o(new Date),d(null)}catch(x){d("Failed to fetch calendar events"),console.error(x)}finally{n(!1)}};h();const i=setInterval(h,20*60*1e3);return()=>clearInterval(i)},[]),a?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):e.jsxs("div",{className:`rounded-lg shadow-sm ${t}`,children:[e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",style:{display:"none"},children:["Last updated: ",m==null?void 0:m.toLocaleString()]}),r&&Object.keys(r||{}).length>0?Object.values(r||{}).slice(0,4).map((h,i)=>e.jsx("div",{className:"w-1/4",children:e.jsx(C,{dayEvents:h,dayDate:Object.keys(r)[i]},i)},i)):e.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})}),u&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading calendar: ",u]})]})}function M(){var x;const[t,r]=l.useState([]),[s,a]=l.useState(!0),[n,u]=l.useState(null),[d,m]=l.useState(!0),o=l.useRef(null),h=1e3*10;l.useEffect(()=>{const c=async()=>{try{const v=await g.get("/messages/feed");u(null),r(v.data.data),a(!1)}catch(v){u("Failed"+JSON.stringify(v)),a(!1)}};c();const f=setInterval(()=>{c()},1e3*60*1);return()=>clearInterval(f)},[]),l.useEffect(()=>{const c=()=>{m(!0),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{m(!1)},h)},f=()=>c(),v=["mousemove","keydown","mousedown","touchstart","scroll"];return v.forEach(j=>window.addEventListener(j,f,{passive:!0})),c(),()=>{v.forEach(j=>window.removeEventListener(j,f)),o.current&&clearTimeout(o.current)}},[]);const i=((x=_().props.auth)==null?void 0:x.user)??!1;return e.jsxs("div",{className:"w-full",children:[s&&e.jsx("div",{children:"Loading messages..."}),e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("div",{style:{overflowY:"auto",maxHeight:"30vh",scrollbarWidth:"none",msOverflowStyle:"none"},className:"w-full",children:[e.jsx("style",{children:`
                            [data-hide-scrollbar]::-webkit-scrollbar {
                                display: none;
                            }
                        `}),e.jsx("div",{"data-hide-scrollbar":!0,children:t.length===0?!s&&e.jsx("div",{className:"text-muted-foreground",children:"No messages available"}):t.map(c=>e.jsxs("div",{className:"my-1 flex flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:c.name}),e.jsx("span",{children:new Date(c.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:c.content})]},c.id))})]})}),n&&e.jsx("div",{className:"text-red-500",children:n}),i&&e.jsxs("form",{className:`mt-2 flex gap-2 transition-opacity duration-500 ${d?"opacity-100":"pointer-events-none opacity-0"}`,onSubmit:async c=>{c.preventDefault();const f=c.target,v=new FormData(f),j=String(v.get("content")||"").trim();if(j)try{await g.post("/messages",{content:j}),f.reset();const N=await g.get("/messages/feed");r(N.data.data),u(null)}catch(N){u("Failed"+JSON.stringify(N))}},children:[e.jsx("input",{name:"content",placeholder:"Write a message...",className:"flex-1 rounded border border-gray-300 p-2 text-sm text-black",onFocus:()=>m(!0)}),e.jsx("button",{type:"submit",className:"rounded bg-blue-600 px-3 py-2 text-sm text-white",children:"Send"})]})]})}const F=({endpoint:t="/prayer-requests/dashboard",limit:r})=>{const[s,a]=l.useState([]),[n,u]=l.useState(!0),[d,m]=l.useState(null),o=l.useRef(null),h=1e3*10;return l.useEffect(()=>{const i=async()=>{try{const c=await fetch(t);if(m(null),!c.ok)throw new Error("Failed to fetch prayer requests");const v=(await c.json()).data||[];a(r?v.slice(0,r):v),m(null),u(!1)}catch(c){m(c instanceof Error?c.message:"Failed to fetch prayer requests"),u(!1)}};i();const x=setInterval(()=>{i()},1e3*60*1);return()=>clearInterval(x)},[t,r]),l.useEffect(()=>{const i=()=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{console.log("User has been idle for 10 seconds")},h)},x=()=>i(),c=["mousemove","keydown","mousedown","touchstart","scroll"];return c.forEach(f=>window.addEventListener(f,x,{passive:!0})),i(),()=>{c.forEach(f=>window.removeEventListener(f,x)),o.current&&clearTimeout(o.current)}},[]),n?e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Loading prayer requests..."}):e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("div",{style:{overflowY:"auto",maxHeight:"30vh",scrollbarWidth:"none",msOverflowStyle:"none"},className:"w-full",children:[e.jsx("style",{children:`
                            [data-hide-scrollbar]::-webkit-scrollbar {
                                display: none;
                            }
                        `}),e.jsx("div",{"data-hide-scrollbar":!0,children:s.length===0?!n&&e.jsx("div",{className:"text-primary-foreground opacity-70",children:"No prayer requests available"}):s.map(i=>e.jsxs("div",{className:`my-1 flex flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors ${i.is_answered?"opacity-60":""}`,children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:i.prayer_request_from||"Unnamed"}),e.jsx("span",{className:"text-lg",children:i.is_answered?"●":"○"})]}),e.jsxs("div",{className:`text-sm text-white ${i.is_answered?"line-through":""}`,children:[i.prayer_for&&e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"For:"})," ",i.prayer_for]}),i.prayer_request&&e.jsxs("div",{className:"mb-1 text-green-200",children:[e.jsx("span",{className:"font-medium",children:"Request:"})," ",i.prayer_request]})]}),e.jsx("div",{className:"text-xs text-gray-300",children:i.answered_at&&e.jsxs("span",{children:["Answered: ",new Date(i.answered_at).toLocaleDateString()]})})]},i.id))}),d&&e.jsxs("div",{className:"text-red-500",children:["Error: ",d]})]})})})},O={async getCurrentWeather(){return(await g.get("/api/weather/current")).data.data},async getForecast(){return(await g.get("/api/weather/forecast")).data.data}};var D={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},S=p.createContext&&p.createContext(D),R=["attr","size","title"];function H(t,r){if(t==null)return{};var s=q(t,r),a,n;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(n=0;n<u.length;n++)a=u[n],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(s[a]=t[a])}return s}function q(t,r){if(t==null)return{};var s={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){if(r.indexOf(a)>=0)continue;s[a]=t[a]}return s}function b(){return b=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},b.apply(this,arguments)}function E(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,a)}return s}function w(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?E(Object(s),!0).forEach(function(a){z(t,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):E(Object(s)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(s,a))})}return t}function z(t,r,s){return r=A(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function A(t){var r=U(t,"string");return typeof r=="symbol"?r:r+""}function U(t,r){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var a=s.call(t,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function L(t){return t&&t.map((r,s)=>p.createElement(r.tag,w({key:s},r.attr),L(r.child)))}function B(t){return r=>p.createElement($,b({attr:w({},t.attr)},r),L(t.child))}function $(t){var r=s=>{var{attr:a,size:n,title:u}=t,d=H(t,R),m=n||s.size||"1em",o;return s.className&&(o=s.className),t.className&&(o=(o?o+" ":"")+t.className),p.createElement("svg",b({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,a,d,{className:o,style:w(w({color:t.color||s.color},s.style),t.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),u&&p.createElement("title",null,u),t.children)};return S!==void 0?p.createElement(S.Consumer,null,s=>r(s)):r(D)}function G(t){return B({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 11c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 2c0-3.31-2.69-6-6-6s-6 2.69-6 6c0 2.22 1.21 4.15 3 5.19l1-1.74c-1.19-.7-2-1.97-2-3.45 0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.48-.81 2.75-2 3.45l1 1.74c1.79-1.04 3-2.97 3-5.19zM12 3C6.48 3 2 7.48 2 13c0 3.7 2.01 6.92 4.99 8.65l1-1.73C5.61 18.53 4 15.96 4 13c0-4.42 3.58-8 8-8s8 3.58 8 8c0 2.96-1.61 5.53-4 6.92l1 1.73c2.99-1.73 5-4.95 5-8.65 0-5.52-4.48-10-10-10z"},child:[]}]})(t)}function J(){var o,h;const[t,r]=l.useState(null),[s,a]=l.useState(!0),[n,u]=l.useState(null),[d,m]=l.useState(null);return l.useEffect(()=>{const i=async()=>{try{u(null);const c=await O.getCurrentWeather();console.log(c),r(c),m(new Date)}catch(c){u("Failed to fetch current weather"),console.error(c)}finally{a(!1)}};i();const x=setInterval(i,15*60*1e3);return()=>clearInterval(x)},[]),s?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):!t||!t.current?e.jsxs("div",{className:"h-40 w-full",children:[e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsx("div",{className:"flex h-full items-center justify-center text-primary-foreground opacity-70",children:"Weather unavailable"})}),n&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading Current Weather: ",n]})]}):e.jsxs("div",{className:"h-40 w-full",children:[e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsx("div",{className:"flex flex-row gap-1 align-middle",children:e.jsxs("h1",{className:"text-5xl",children:[((o=t==null?void 0:t.current)==null?void 0:o.home_assistant_current_temp)??"-","°"]})}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[e.jsx(G,{}),e.jsxs("h3",{className:"text-base",children:[((h=t==null?void 0:t.current)==null?void 0:h.temp_f)??"-","°"]})]}),e.jsx("div",{className:"text-small text-muted-foreground",children:d==null?void 0:d.toLocaleString()})]})}),n&&e.jsxs("div",{className:"p-4 text-muted-foreground",children:["Error loading Current Weather: ",n]})]})}const V=()=>{const[t,r]=l.useState(null),[s,a]=l.useState(!0),[n,u]=l.useState(null);return l.useEffect(()=>{const d=async()=>{try{const o=await O.getForecast();r(o),u(new Date)}catch(o){console.error("Failed to load forecast:",o)}finally{a(!1)}};d();const m=setInterval(d,20*60*1e3);return()=>clearInterval(m)},[]),s?e.jsx("div",{children:"Loading forecast..."}):!t||!t.forecast?e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Forecast unavailable"}):e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:t.forecast.map(d=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:P(new Date(d.date+"T00:00:00")).replace("Next ","")}),e.jsxs("div",{children:[e.jsx("img",{src:d.day.condition.icon,alt:d.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(d.day.maxtemp_f),"°"]})," / ",e.jsxs("span",{className:"",children:[Math.round(d.day.mintemp_f),"°"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[d.day.daily_chance_of_rain,"%"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n==null?void 0:n.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"})," ",n==null?void 0:n.toLocaleTimeString()]})]})]})]},d.date_epoch))})})};function ee(){const[t,r]=l.useState(!0);return l.useEffect(()=>{const s=async()=>{try{const n=await g.get("/api/settings/public");r(n.data.show_prayer_requests??!0)}catch(n){console.error("Failed to fetch settings:",n),r(!0)}};s();const a=setInterval(s,3e4);return()=>clearInterval(a)},[]),e.jsx(T,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-4 p-4",children:[e.jsx(Y,{}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"text-5xl text-primary-foreground",children:e.jsx(K,{})})}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"text-5xl text-primary-foreground"})}),e.jsx("div",{className:"w-1/4",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Weather unavailable"}),children:e.jsx(J,{})})})]}),e.jsx("div",{className:"flex",children:e.jsx("div",{className:"w-full",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Forecast unavailable"}),children:e.jsx(V,{})})})}),e.jsx("div",{className:"flex w-1/3 items-center justify-start",children:e.jsx("div",{className:"w-full",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Message unavailable"}),children:e.jsx(M,{})})})}),t&&e.jsx("div",{className:"flex w-1/3 items-center justify-start",children:e.jsx("div",{className:"w-full",children:e.jsx(y,{intervalMs:1e3*60*1,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Prayer requests unavailable"}),children:e.jsx(F,{limit:8})})})}),e.jsx("div",{className:"mt-auto",children:e.jsx(y,{intervalMs:1e4,fallback:e.jsx("div",{className:"text-primary-foreground opacity-70",children:"Calendar unavailable"}),children:e.jsx(W,{})})})]})})}function Y(){return e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:`
        linear-gradient(to bottom,
            rgba(0, 0, 0, 0.2) 50%,
            rgba(0, 0, 0, 0) 20%,
            rgba(0, 0, 0, 0) 30%,
            rgba(0, 0, 0, .2) 50%
        )
    `}})}function K(){const[t,r]=l.useState(new Date);return l.useEffect(()=>{r(new Date);const s=setInterval(()=>{r(new Date)},1e3*60);return()=>clearInterval(s)},[]),e.jsxs("div",{children:[e.jsx("div",{className:"text-8xl text-primary-foreground",children:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:t.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}export{ee as default};
//# sourceMappingURL=HaDashboard-BZTwEvzl.js.map
