import{b as h,j as e,r as l}from"./app-CZkVJ2si.js";import{H as v}from"./HaDashboardLayout-SgpA0_RM.js";const p={async getEvents(){return(await h.get("/api/calendar-events")).data.data}};function y({dayEvents:s,dayDate:r}){return s.length?e.jsxs("div",{className:"flex flex-col text-primary-foreground",children:[e.jsx("span",{className:"text-lg",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("hr",{className:"border-[0.5px] border-gray-400"}),s.map(a=>e.jsx("div",{className:"my-1 border-l-4 border-l-primary ps-1",children:e.jsx(N,{event:a})},a.id))]}):null}function N({event:s}){return s.isAllDay?e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsx("span",{className:"text-sm text-[#A9A9A9]",children:"All day"}),e.jsx("span",{children:s.summary})]})}):e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col justify-between text-lg",children:[e.jsxs("span",{children:[new Date(s.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})," - ",new Date(s.end.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})]}),e.jsx("span",{children:s.summary})]})})}function w({className:s}){const[r,a]=l.useState(null),[n,i]=l.useState(!0),[c,t]=l.useState(null),[d,o]=l.useState(null);return l.useEffect(()=>{const x=async()=>{try{const f=await p.getEvents();a(f),o(new Date)}catch(f){t("Failed to fetch calendar events"),console.error(f)}finally{i(!1)}};x();const u=setInterval(x,20*60*1e3);return()=>clearInterval(u)},[]),n?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Calendar..."})}):c?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading calendar: ",c]}):e.jsx("div",{className:`rounded-lg shadow-sm ${s}`,children:e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",style:{display:"none"},children:["Last updated: ",d==null?void 0:d.toLocaleString()]}),r&&Object.keys(r).length>0?Object.values(r).slice(0,4).map((x,u)=>e.jsx("div",{className:"w-1/4",children:e.jsx(y,{dayEvents:x,dayDate:Object.keys(r)[u]},u)},u)):e.jsx("div",{className:"w-full text-center text-muted-foreground",children:"No calendar events found"})]})})})}function b(){const[s,r]=l.useState([]),[a,n]=l.useState(!0),[i,c]=l.useState(null);return l.useEffect(()=>{const t=async()=>{try{const o=await h.get("/api/messages");c(null),r(o.data.data),n(!1)}catch(o){c("Failed"+JSON.stringify(o)),n(!1)}};t();const d=setInterval(()=>{t()},1e3*60*1);return()=>clearInterval(d)},[]),a?e.jsx("div",{children:"Loading messages..."}):i?e.jsx("div",{className:"text-red-500",children:i}):e.jsx("div",{className:"",children:e.jsx("div",{className:"max-h-[30vh] overflow-y-auto",children:s.map(t=>e.jsxs("div",{className:"my-1 flex w-1/3 flex-col rounded-xl bg-white bg-opacity-10 p-1 backdrop-blur-sm transition-colors",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-gray-300",children:[e.jsx("span",{className:"text-xs font-medium",children:t.name}),e.jsx("span",{children:new Date(t.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-white",children:t.content})]},t.id))})})}const j={async getCurrentWeather(){return(await h.get("/api/weather/current")).data.data},async getForecast(){return(await h.get("/api/weather/forecast")).data.data}};function S(){const[s,r]=l.useState(null),[a,n]=l.useState(!0),[i,c]=l.useState(null),[t,d]=l.useState(null);return l.useEffect(()=>{const o=async()=>{try{c(null);const u=await j.getCurrentWeather();r(u),d(new Date)}catch(u){c("Failed to fetch current weather"),console.error(u)}finally{n(!1)}};o();const x=setInterval(o,15*60*1e3);return()=>clearInterval(x)},[]),a?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"",children:"Loading Weather..."})}):i?e.jsxs("div",{className:"p-4 text-destructive",children:["Error loading weather: ",i]}):e.jsx("div",{className:"h-40 w-full",children:e.jsx("div",{className:"inline-block h-40 w-full rounded-md bg-white bg-opacity-10 p-4 backdrop-blur-sm transition-colors",children:e.jsxs("div",{className:"flex flex-col justify-between text-primary-foreground",children:[e.jsx("div",{className:"flex items-end",children:e.jsxs("h1",{className:"text-5xl",children:[s==null?void 0:s.current.temp_f,"째"]})}),e.jsx("div",{className:"flex items-center",children:e.jsxs("h3",{className:"text-base",children:["Feels Like: ",s.current.feelslike_f,"째"]})}),e.jsx("div",{className:"text-small text-muted-foreground",children:t==null?void 0:t.toLocaleString()})]})})})}function E(s){const r=new Date;r.setHours(0,0,0,0);const a=new Date(s);a.setHours(0,0,0,0);const n=(a.getTime()-r.getTime())/(1e3*60*60*24);return n===0?"Today":n===1?"Tomorrow":n<7&&n>1?`Next ${a.toLocaleDateString(void 0,{weekday:"long"})}`:a.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}const D=()=>{const[s,r]=l.useState(null),[a,n]=l.useState(!0),[i,c]=l.useState(null);return l.useEffect(()=>{const t=async()=>{try{const o=await j.getForecast();r(o),c(new Date)}catch(o){console.error("Failed to load forecast:",o)}finally{n(!1)}};t();const d=setInterval(t,20*60*1e3);return()=>clearInterval(d)},[]),a?e.jsx("div",{children:"Loading forecast..."}):s?e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-5 gap-4 transition-colors",children:s.forecast.map(t=>e.jsxs("div",{className:"flex flex-col justify-around p-4 text-primary-foreground",children:[e.jsx("div",{className:"text-lg font-semibold",children:E(new Date(t.date+"T00:00:00")).replace("Next ","")}),e.jsxs("div",{children:[e.jsx("img",{src:t.day.condition.icon,alt:t.day.condition.text,className:"mx-auto h-16 w-16"}),e.jsxs("div",{className:"text-center align-baseline",children:[e.jsxs("div",{className:"text-lg",children:[e.jsxs("span",{className:"",children:[Math.round(t.day.maxtemp_f),"째"]})," / ",e.jsxs("span",{className:"",children:[Math.round(t.day.mintemp_f),"째"]})]}),e.jsxs("div",{className:"text text-sm text-gray-400",children:[t.day.daily_chance_of_rain,"%"]})]})]})]},t.date_epoch))})}):e.jsx("div",{children:"Unable to load forecast"})},L=l.createContext(null),g={didCatch:!1,error:null};class m extends l.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=g}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var a,n,i=arguments.length,c=new Array(i),t=0;t<i;t++)c[t]=arguments[t];(a=(n=this.props).onReset)===null||a===void 0||a.call(n,{args:c,reason:"imperative-api"}),this.setState(g)}}componentDidCatch(r,a){var n,i;(n=(i=this.props).onError)===null||n===void 0||n.call(i,r,a)}componentDidUpdate(r,a){const{didCatch:n}=this.state,{resetKeys:i}=this.props;if(n&&a.error!==null&&C(r.resetKeys,i)){var c,t;(c=(t=this.props).onReset)===null||c===void 0||c.call(t,{next:i,prev:r.resetKeys,reason:"keys"}),this.setState(g)}}render(){const{children:r,fallbackRender:a,FallbackComponent:n,fallback:i}=this.props,{didCatch:c,error:t}=this.state;let d=r;if(c){const o={error:t,resetErrorBoundary:this.resetErrorBoundary};if(typeof a=="function")d=a(o);else if(n)d=l.createElement(n,o);else if(i!==void 0)d=i;else throw t}return l.createElement(L.Provider,{value:{didCatch:c,error:t,resetErrorBoundary:this.resetErrorBoundary}},d)}}function C(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return s.length!==r.length||s.some((a,n)=>!Object.is(a,r[n]))}function F(){return e.jsx(v,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"HA Dashboard"}),children:e.jsxs("div",{className:"relative flex h-screen flex-col gap-1 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(k,{})}),e.jsx("div",{className:"h-40 w-1/3 justify-end",children:e.jsx("div",{className:"flex items-center",children:e.jsx(m,{fallback:e.jsx("div",{children:"Error loading current weather"}),children:e.jsx(S,{})})})})]}),e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx("div",{className:"w-full",children:e.jsx(m,{fallback:e.jsx("div",{children:"Error loading forecast weather"}),children:e.jsx(D,{})})})}),e.jsx("div",{className:"flex gap-4",children:e.jsx("div",{className:"w-full max-w-7xl",children:e.jsx(m,{fallback:e.jsx("div",{children:"Error loading custom messages"}),children:e.jsx(b,{})})})}),e.jsx("div",{className:"h-1/3",children:e.jsx(m,{fallback:e.jsx("div",{children:"Error loading calendar"}),children:e.jsx(w,{})})})]})})}function k(){const[s,r]=l.useState(new Date);return l.useEffect(()=>{r(new Date);const a=setInterval(()=>{r(new Date)},1e3*60);return()=>clearInterval(a)},[]),e.jsxs("div",{children:[e.jsx("div",{className:"text-8xl text-primary-foreground",children:s.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).replace("AM","").replace("PM","")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl text-primary-foreground",children:s.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("span",{className:"text-lg text-primary-foreground",children:s.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}export{F as default};
//# sourceMappingURL=HaDashboard-CyGaizm9.js.map
